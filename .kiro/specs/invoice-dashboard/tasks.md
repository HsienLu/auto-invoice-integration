# 發票整理儀表板實作計劃

## 重要開發環境註記
**所有開發工作都必須在 Docker 環境下進行**
- 使用 `docker-compose up -dev` 啟動開發環境
- 所有 npm 指令都應在 Docker 容器內執行
- 確保代碼變更透過 volume 掛載即時反映
- 測試和建置也都在容器環境中進行

- [x] 1. 專案初始化和基礎設定




- [x] 1.1 建立 Docker 開發環境


  - 建立 Dockerfile 使用 Node.js 20-alpine 作為基礎映像
  - 設定 docker-compose.yml 檔案
  - 配置容器環境 (Node.js 20.x, npm 10.x)
  - 設定 volume 掛載和熱重載功能
  - 暴露開發伺服器端口 (3000) 和除錯端口
  - _需求: 開發環境標準化_

- [x] 1.2 初始化專案結構


  - 在 Docker 容器中建立 React 18 + TypeScript 5.x 專案
  - 安裝和設定 Tailwind CSS 3.x
  - 安裝 shadcn/ui 最新版本和相關依賴
  - 安裝 React Router v6.x
  - 安裝 Zustand 4.x 狀態管理
  - 設定 ESLint 8.x、Prettier 3.x 和基本開發工具
  - 建立開發和生產環境的 Docker 設定
  - _需求: 1.1, 1.2, 1.3_

- [x] 2. 建立基礎路由和導航結構





  - 安裝和設定 React Router v6
  - 建立主要頁面組件的骨架 (Dashboard, FileManager, Analytics)
  - 實作導航組件和側邊欄
  - 設定路由守衛和重定向邏輯
  - _需求: 1.1_

- [x] 3. 設定狀態管理和資料模型





  - 安裝和設定 Zustand
  - 定義 TypeScript 介面 (Invoice, InvoiceItem, Statistics, FileInfo)
  - 建立基礎的 store 結構和狀態管理邏輯
  - 實作本地儲存的持久化功能
  - _需求: 1.1, 1.2, 1.3_

- [x] 4. 實作 CSV 檔案解析功能






  - 安裝 PapaParse 5.x 並建立 CSV 解析器
  - 實作發票資料的解析邏輯 (M行和D行格式)
  - 建立資料驗證和錯誤處理機制
  - 實作解析進度顯示和使用者回饋
  - 撰寫 CSV 解析功能的單元測試
  - _需求: 1.1, 1.2, 1.3_

- [x] 5. 建立檔案管理頁面




- [x] 5.1 實作檔案上傳組件


  - 使用 shadcn/ui 建立檔案拖放上傳介面
  - 實作檔案格式驗證和大小限制
  - 顯示上傳進度和狀態回饋
  - _需求: 6.2, 6.4_

- [x] 5.2 實作檔案清單顯示


  - 建立檔案清單表格組件
  - 顯示檔案資訊 (名稱、大小、上傳日期、狀態)
  - 實作檔案刪除功能和確認對話框
  - _需求: 6.1, 6.3_



- [x] 5.3 實作檔案重新載入功能





  - 建立重新處理檔案的功能
  - 更新相關統計資料
  - 處理檔案載入錯誤和修正建議
  - _需求: 6.5, 6.4_

- [x] 6. 建立資料處理和統計計算邏輯






  - 實作消費統計計算函數 (總金額、平均金額、發票數量)
  - 建立時間序列資料處理邏輯
  - 實作品項分類和統計功能
  - 處理作廢發票的過濾邏輯
  - 撰寫統計計算的單元測試
  - _需求: 2.1, 2.3, 3.1, 3.2, 4.1, 4.2_

- [x] 7. 實作主儀表板頁面





- [x] 7.1 建立統計卡片組件


  - 使用 shadcn/ui 建立統計概覽卡片
  - 顯示總消費金額、發票數量、平均消費
  - 實作響應式設計和載入狀態
  - _需求: 2.1_

- [x] 7.2 實作時間趨勢圖表


  - 安裝 Chart.js 4.x 和 react-chartjs-2 5.x
  - 建立日消費趨勢折線圖
  - 建立月消費統計柱狀圖
  - 實作圖表互動和數據點點擊功能
  - _需求: 3.1, 3.2, 3.3_

- [x] 7.3 實作品項分析圖表


  - 建立品項分類統計圖表
  - 實作購買頻率分析視覺化
  - 加入圖表篩選和互動功能
  - _需求: 4.1, 4.2, 4.3_

- [x] 8. 建立詳細分析頁面




- [x] 8.1 實作資料篩選面板


  - 建立日期範圍選擇器
  - 實作商店名稱搜尋功能
  - 建立金額範圍篩選器
  - 實作篩選條件的組合邏輯
  - _需求: 5.1, 5.2, 5.3_

- [x] 8.2 建立詳細資料表格


  - 使用 shadcn/ui 建立可排序的資料表格
  - 實作分頁和虛擬滾動功能
  - 顯示完整的發票和明細資訊
  - 實作表格欄位的客製化顯示
  - _需求: 5.1, 5.2, 5.3_

- [x] 8.3 實作進階圖表功能


  - 建立可互動的詳細分析圖表
  - 實作圖表類型切換功能
  - 加入圖表資料匯出功能
  - _需求: 3.3, 4.3_

- [x] 9. 實作資料匯出功能





- [x] 9.1 建立 CSV 匯出功能


  - 實作篩選資料的 CSV 匯出
  - 建立自訂欄位選擇功能
  - 處理大量資料的匯出效能
  - _需求: 7.1_

- [x] 9.2 實作統計報告匯出


  - 安裝 jsPDF 2.x 和 html2canvas 1.x
  - 建立包含圖表的 PDF 報告模板
  - 實作報告生成和下載功能
  - _需求: 7.2_

- [x] 9.3 處理匯出錯誤和使用者回饋


  - 實作匯出進度顯示
  - 建立錯誤處理和重試機制
  - 提供清楚的錯誤訊息和解決建議
  - _需求: 7.3_

- [x] 10. 實作錯誤處理和使用者體驗優化





  - 建立全域錯誤邊界組件
  - 實作載入狀態和骨架屏效果
  - 建立友善的錯誤訊息和修正建議
  - 實作離線狀態處理
  - _需求: 1.2, 6.4_
-

- [x] 11. 效能優化和測試




- [x] 11.1 實作效能優化


  - 使用 React.memo 和 useMemo 優化組件渲染
  - 實作圖表資料的快取機制
  - 優化大檔案處理的記憶體使用
  - _需求: 所有需求的效能考量_

- [x] 11.2 撰寫整合測試


  - 建立檔案上傳流程的整合測試
  - 測試資料篩選和圖表互動功能
  - 驗證匯出功能的完整性
  - _需求: 所有主要功能_

- [x] 11.3 進行端到端測試


  - 安裝 Playwright 1.x (推薦) 或 Cypress 13.x
  - 建立完整使用者工作流程的測試
  - 測試跨瀏覽器相容性
  - 驗證響應式設計
  - _需求: 所有使用者故事_
-

- [ ] 12. 最終整合和部署準備



  - 整合所有功能模組
  - 進行完整的功能測試和使用者驗收
  - 優化打包大小和載入效能
  - 建立生產環境的 Docker 映像檔
  - 準備部署設定和文檔 (包含 Docker 部署指南)
  - _需求: 所有需求的整合驗證_